;
; M32ASSEM_CH13-ADC_DAC.asm
;
; Created: 28/04/2018 11:20:10
; Author : Mahmoud
;


;ADC USING INTERRUPTS
/*
.INCLUDE "M32DEF.INC"

.ORG 0X00
JMP MAIN

LDI R16,HIGH(RAMEND)
OUT SPH,R16
LDI R16,LOW(RAMEND)
OUT SPL,R16

.ORG 0X20
JMP ADC_ISR


MAIN :
			LDI R16,0X00
			OUT DDRA,R16
			LDI R16,0XFF
			OUT DDRB,R16
			LDI R16,(1<<ADEN)|(1<<ADPS0)|(1<<ADPS1)|(1<<ADPS2)|(1<<ADIE)
			OUT ADCSRA,R16
			LDI R16,(1<<ADLAR)|(1<<REFS0)
			OUT ADMUX,R16

			
			
WHILEONE :
			SBI ADCSRA,ADSC
			;LDI R16,(1<<ADSC)
WAIT_CONV_COMP :
			SBIS ADCSRA,ADIF
			RJMP WAIT_CONV_COMP
			SBI ADCSRA,ADIF
			IN R17,ADCH
			OUT PORTB,R17
RJMP WHILEONE

RJMP MAIN


ADC_ISR :
			SBI ADCSRA,ADIF
			IN R17,ADCH
			OUT PORTB,R17
RETI
*/

/*
.INCLUDE "M32DEF.INC"

.ORG 0X00
JMP MAIN

LDI R16,HIGH(RAMEND)
OUT SPH,R16
LDI R16,LOW(RAMEND)
OUT SPL,R16


MAIN :
			LDI R16,0X00
			OUT DDRA,R16
			LDI R16,0XFF
			OUT DDRB,R16
			LDI R16,(1<<ADEN)|(1<<ADPS0)|(1<<ADPS1)|(1<<ADPS2)
			OUT ADCSRA,R16
			LDI R16,(1<<ADLAR)|(1<<REFS0)
			OUT ADMUX,R16

			
			;LDI R16,(1<<ADSC)
WHILEONE :
			OUT ADCSRA,R16
			SBI ADCSRA,ADSC
WAIT_CONV_COMP :
			SBIS ADCSRA,ADIF
			RJMP WAIT_CONV_COMP
			SBI ADCSRA,ADIF
			IN R17,ADCH
			OUT PORTB,R17
RJMP WHILEONE

RJMP MAIN

*/